import { Category } from '../types';

export const django: Category = {
    id: 'django',
    name: 'Django (Full)',
    description: 'Complete Django web framework reference â€” models, views, URLs, templates, ORM, admin, forms, DRF, and a mini todo app project',
    icon: 'Server',
    entries: [
        { id: 'django-setup', name: 'Django Project Setup', signature: 'django-admin startproject myproject', description: 'Create and configure a Django project with apps.', example: '# Create project\n# django-admin startproject myproject\n# cd myproject\n# python manage.py startapp myapp\n\n# settings.py\nINSTALLED_APPS = [\n    "django.contrib.admin",\n    "django.contrib.auth",\n    "django.contrib.contenttypes",\n    "django.contrib.sessions",\n    "myapp",  # Add your app\n]\n\n# Run server\n# python manage.py runserver', tags: ['setup', 'project', 'create'] },
        { id: 'django-models', name: 'Models (Database)', signature: 'class MyModel(models.Model): ...', description: 'Define database tables as Python classes. Django auto-generates SQL.', example: 'from django.db import models\n\nclass Post(models.Model):\n    title = models.CharField(max_length=200)\n    content = models.TextField()\n    author = models.ForeignKey("auth.User", on_delete=models.CASCADE)\n    created_at = models.DateTimeField(auto_now_add=True)\n    published = models.BooleanField(default=False)\n    tags = models.ManyToManyField("Tag", blank=True)\n\n    def __str__(self):\n        return self.title\n\n    class Meta:\n        ordering = ["-created_at"]\n\nclass Tag(models.Model):\n    name = models.CharField(max_length=50, unique=True)', tags: ['model', 'database', 'schema'] },
        { id: 'django-fields', name: 'Model Fields', signature: 'models.CharField, IntegerField, ForeignKey, etc.', description: 'All common Django model field types for defining database columns.', example: '# Text fields\nmodels.CharField(max_length=100)    # Short text\nmodels.TextField()                   # Long text\nmodels.EmailField()                  # Validates email\nmodels.URLField()                    # Validates URL\nmodels.SlugField()                   # URL-friendly slug\n\n# Number fields\nmodels.IntegerField()                # Integer\nmodels.FloatField()                  # Float\nmodels.DecimalField(max_digits=10, decimal_places=2)\n\n# Date/time\nmodels.DateField(auto_now_add=True)  # Auto-set on create\nmodels.DateTimeField(auto_now=True)  # Auto-update\n\n# Relationships\nmodels.ForeignKey(User, on_delete=models.CASCADE)  # Many-to-one\nmodels.ManyToManyField(Tag)                         # Many-to-many\nmodels.OneToOneField(Profile, on_delete=models.CASCADE)\n\n# Other\nmodels.BooleanField(default=False)\nmodels.FileField(upload_to="uploads/")\nmodels.ImageField(upload_to="images/")\nmodels.JSONField(default=dict)', tags: ['fields', 'types', 'schema'] },
        { id: 'django-migrations', name: 'Migrations', signature: 'python manage.py makemigrations / migrate', description: 'Track and apply database schema changes automatically.', example: '# After changing models:\n# python manage.py makemigrations      â€” Generate migration files\n# python manage.py migrate              â€” Apply migrations\n# python manage.py showmigrations       â€” Show status\n# python manage.py sqlmigrate app 0001  â€” Show SQL\n# python manage.py migrate app 0001     â€” Rollback to specific migration', tags: ['migration', 'schema', 'database'] },
        { id: 'django-views-fbv', name: 'Function-Based Views', signature: 'def view(request): return HttpResponse()', description: 'Simple function views that take a request and return a response.', example: 'from django.shortcuts import render, get_object_or_404, redirect\nfrom django.http import HttpResponse, JsonResponse\n\ndef home(request):\n    return render(request, "home.html")\n\ndef post_list(request):\n    posts = Post.objects.all()\n    return render(request, "posts/list.html", {"posts": posts})\n\ndef post_detail(request, pk):\n    post = get_object_or_404(Post, pk=pk)\n    return render(request, "posts/detail.html", {"post": post})\n\ndef api_posts(request):\n    posts = list(Post.objects.values("id", "title"))\n    return JsonResponse(posts, safe=False)', tags: ['view', 'function', 'request', 'response'] },
        { id: 'django-views-cbv', name: 'Class-Based Views', signature: 'class MyView(View): ...', description: 'Object-oriented views with reusable behavior. Django provides many generic views.', example: 'from django.views.generic import ListView, DetailView, CreateView, UpdateView, DeleteView\n\nclass PostListView(ListView):\n    model = Post\n    template_name = "posts/list.html"\n    context_object_name = "posts"\n    paginate_by = 10\n\nclass PostDetailView(DetailView):\n    model = Post\n    template_name = "posts/detail.html"\n\nclass PostCreateView(CreateView):\n    model = Post\n    fields = ["title", "content"]\n    success_url = "/posts/"\n\n    def form_valid(self, form):\n        form.instance.author = self.request.user\n        return super().form_valid(form)', tags: ['view', 'class', 'generic'] },
        { id: 'django-urls', name: 'URL Configuration', signature: 'urlpatterns = [path("route/", view)]', description: 'Map URLs to views. Supports parameters, namespacing, and includes.', example: 'from django.urls import path, include\nfrom . import views\n\nurlpatterns = [\n    path("", views.home, name="home"),\n    path("posts/", views.PostListView.as_view(), name="post-list"),\n    path("posts/<int:pk>/", views.PostDetailView.as_view(), name="post-detail"),\n    path("posts/<slug:slug>/", views.post_by_slug, name="post-slug"),\n    path("api/", include("api.urls")),  # Include app URLs\n]\n\n# Project urls.py\nfrom django.contrib import admin\nurlpatterns = [\n    path("admin/", admin.site.urls),\n    path("", include("myapp.urls")),\n]', tags: ['url', 'routing', 'path'] },
        { id: 'django-templates', name: 'Django Templates (DTL)', signature: '{{ variable }} {% tag %} {{ value|filter }}', description: 'Django Template Language for rendering HTML with dynamic data.', example: '<!-- templates/posts/list.html -->\n{% extends "base.html" %}\n{% block content %}\n  <h1>Posts</h1>\n  {% for post in posts %}\n    <article>\n      <h2>{{ post.title }}</h2>\n      <p>{{ post.content|truncatewords:30 }}</p>\n      <small>By {{ post.author.username }} on {{ post.created_at|date:"M d, Y" }}</small>\n      {% if post.published %}\n        <span class="badge">Published</span>\n      {% endif %}\n    </article>\n  {% empty %}\n    <p>No posts yet.</p>\n  {% endfor %}\n{% endblock %}', tags: ['template', 'html', 'dtl'] },
        { id: 'django-forms', name: 'Forms & ModelForm', signature: 'class MyForm(forms.ModelForm): ...', description: 'Handle form submission, validation, and rendering with Django forms.', example: 'from django import forms\n\nclass PostForm(forms.ModelForm):\n    class Meta:\n        model = Post\n        fields = ["title", "content", "published"]\n        widgets = {\n            "content": forms.Textarea(attrs={"rows": 5}),\n        }\n\n    def clean_title(self):\n        title = self.cleaned_data["title"]\n        if len(title) < 5:\n            raise forms.ValidationError("Title too short")\n        return title\n\n# In view\ndef create_post(request):\n    form = PostForm(request.POST or None)\n    if form.is_valid():\n        post = form.save(commit=False)\n        post.author = request.user\n        post.save()\n        return redirect("post-list")\n    return render(request, "posts/create.html", {"form": form})', tags: ['form', 'validation', 'modelform'] },
        { id: 'django-orm', name: 'ORM QuerySets', signature: 'Model.objects.filter(...).exclude(...)', description: 'Django\'s powerful ORM for querying databases. Chainable, lazy-evaluated QuerySets.', example: '# Basic queries\nPost.objects.all()                              # All posts\nPost.objects.filter(published=True)              # Published only\nPost.objects.exclude(author__username="admin")   # Exclude admin\nPost.objects.get(pk=1)                           # Single object\n\n# Lookups\nPost.objects.filter(title__icontains="python")   # Case-insensitive contains\nPost.objects.filter(created_at__year=2024)       # Year filter\nPost.objects.filter(tags__name__in=["python","django"])\n\n# Chaining\nPost.objects.filter(published=True).order_by("-created_at")[:10]\n\n# Aggregation\nfrom django.db.models import Count, Avg, Q\nPost.objects.aggregate(total=Count("id"), avg_len=Avg("content__length"))\n\n# F and Q expressions\nfrom django.db.models import F, Q\nPost.objects.filter(Q(published=True) | Q(author=request.user))\nPost.objects.update(views=F("views") + 1)', tags: ['orm', 'query', 'filter', 'database'] },
        { id: 'django-admin', name: 'Admin Site', signature: 'admin.site.register(Model)', description: 'Auto-generated admin interface for managing your data. Highly customizable.', example: 'from django.contrib import admin\n\n@admin.register(Post)\nclass PostAdmin(admin.ModelAdmin):\n    list_display = ["title", "author", "created_at", "published"]\n    list_filter = ["published", "created_at"]\n    search_fields = ["title", "content"]\n    prepopulated_fields = {"slug": ("title",)}\n    list_editable = ["published"]\n    date_hierarchy = "created_at"\n    actions = ["publish_selected"]\n\n    def publish_selected(self, request, queryset):\n        queryset.update(published=True)\n    publish_selected.short_description = "Publish selected posts"', tags: ['admin', 'dashboard', 'manage'] },
        { id: 'django-middleware', name: 'Middleware', signature: 'class MyMiddleware: def __call__(self, request): ...', description: 'Process requests and responses globally. Runs for every request.', example: 'import time\n\nclass RequestTimingMiddleware:\n    def __init__(self, get_response):\n        self.get_response = get_response\n\n    def __call__(self, request):\n        start = time.time()\n        response = self.get_response(request)\n        duration = time.time() - start\n        response["X-Request-Duration"] = f"{duration:.4f}s"\n        return response\n\n# settings.py\nMIDDLEWARE = [\n    "myapp.middleware.RequestTimingMiddleware",\n    # ... other middleware\n]', tags: ['middleware', 'process', 'request'] },
        { id: 'django-auth', name: 'Authentication', signature: 'from django.contrib.auth import authenticate, login, logout', description: 'Built-in user authentication system â€” login, logout, registration, permissions.', example: 'from django.contrib.auth import authenticate, login, logout\nfrom django.contrib.auth.decorators import login_required\nfrom django.contrib.auth.models import User\n\ndef login_view(request):\n    if request.method == "POST":\n        user = authenticate(\n            username=request.POST["username"],\n            password=request.POST["password"]\n        )\n        if user:\n            login(request, user)\n            return redirect("home")\n    return render(request, "login.html")\n\n@login_required\ndef profile(request):\n    return render(request, "profile.html")\n\ndef register(request):\n    user = User.objects.create_user(\n        username="alice",\n        email="alice@example.com",\n        password="secret123"\n    )', tags: ['auth', 'login', 'register', 'user'] },
        { id: 'django-signals', name: 'Signals', signature: 'from django.db.models.signals import post_save', description: 'Decouple components by sending/receiving signals when certain actions occur.', example: 'from django.db.models.signals import post_save\nfrom django.dispatch import receiver\n\n@receiver(post_save, sender=User)\ndef create_profile(sender, instance, created, **kwargs):\n    if created:\n        Profile.objects.create(user=instance)\n\n# Can also connect manually:\n# post_save.connect(create_profile, sender=User)', tags: ['signal', 'event', 'decouple'] },
        { id: 'django-management', name: 'Management Commands', signature: 'python manage.py mycommand', description: 'Create custom CLI commands for admin tasks, data imports, maintenance, etc.', example: '# myapp/management/commands/populate_data.py\nfrom django.core.management.base import BaseCommand\n\nclass Command(BaseCommand):\n    help = "Populate database with sample data"\n\n    def add_arguments(self, parser):\n        parser.add_argument("--count", type=int, default=10)\n\n    def handle(self, *args, **options):\n        count = options["count"]\n        for i in range(count):\n            Post.objects.create(\n                title=f"Sample Post {i}",\n                content="Lorem ipsum..."\n            )\n        self.stdout.write(self.style.SUCCESS(f"Created {count} posts"))\n\n# Usage: python manage.py populate_data --count 50', tags: ['command', 'cli', 'admin'] },
        { id: 'django-static-media', name: 'Static & Media Files', signature: 'STATIC_URL, MEDIA_URL, STATICFILES_DIRS', description: 'Serve CSS/JS/images (static) and user-uploaded files (media).', example: '# settings.py\nSTATIC_URL = "/static/"\nSTATICFILES_DIRS = [BASE_DIR / "static"]\nSTATIC_ROOT = BASE_DIR / "staticfiles"\n\nMEDIA_URL = "/media/"\nMEDIA_ROOT = BASE_DIR / "media"\n\n# urls.py (development)\nfrom django.conf import settings\nfrom django.conf.urls.static import static\n\nurlpatterns += static(settings.MEDIA_URL, document_root=settings.MEDIA_ROOT)\n\n# In template\n{% load static %}\n<link rel="stylesheet" href="{% static \'css/style.css\' %}">\n<img src="{{ post.image.url }}" />', tags: ['static', 'media', 'files'] },
        { id: 'django-drf', name: 'Django REST Framework (DRF)', signature: 'from rest_framework import serializers, viewsets', description: 'Build powerful REST APIs with serializers, viewsets, routers, and authentication.', example: 'from rest_framework import serializers, viewsets\nfrom rest_framework.routers import DefaultRouter\n\nclass PostSerializer(serializers.ModelSerializer):\n    class Meta:\n        model = Post\n        fields = ["id", "title", "content", "author", "created_at"]\n\nclass PostViewSet(viewsets.ModelViewSet):\n    queryset = Post.objects.all()\n    serializer_class = PostSerializer\n\n    def perform_create(self, serializer):\n        serializer.save(author=self.request.user)\n\n# urls.py\nrouter = DefaultRouter()\nrouter.register("posts", PostViewSet)\nurlpatterns = [path("api/", include(router.urls))]', tags: ['drf', 'rest', 'api', 'serializer'] },
        { id: 'django-mini-project', name: 'ðŸ”¥ Mini Project: Todo App', signature: 'Complete Django CRUD Application', description: 'A complete Todo application with user authentication, CRUD operations, and REST API.', example: '# Project structure:\n# todoapp/\n#   manage.py\n#   config/settings.py\n#   todos/\n#     models.py    â€” Todo model (title, completed, user, due_date)\n#     views.py     â€” ListView, CreateView, UpdateView, DeleteView\n#     forms.py     â€” TodoForm with validation\n#     urls.py      â€” CRUD URL patterns\n#     admin.py     â€” Admin customization\n#     api/         â€” DRF serializers and viewsets\n#   templates/\n#     base.html    â€” Base layout\n#     todos/list.html, create.html, detail.html\n#   static/\n#     css/style.css', tags: ['project', 'todo', 'crud'] },
    ]
};
