import { Category } from '../types';

export const dataSerialization: Category = {
    id: 'data-serialization',
    name: 'Data & Serialization',
    description: 'Working with data formats — JSON, YAML, TOML, pickle, shelve, XML, base64, and struct',
    icon: 'FileJson',
    entries: [
        { id: 'ser-json', name: 'json Module', signature: 'json.dumps() / json.loads() / json.dump() / json.load()', description: 'Serialize Python objects to JSON strings/files and back. The most common data exchange format.', example: 'import json\n\ndata = {"name": "Alice", "age": 30, "scores": [95, 87, 92]}\n\n# To JSON string\njson_str = json.dumps(data, indent=2, sort_keys=True)\nprint(json_str)\n\n# From JSON string\nparsed = json.loads(json_str)\nprint(parsed["name"])  # Alice\n\n# Custom serialization\nfrom datetime import datetime\n\nclass DateEncoder(json.JSONEncoder):\n    def default(self, obj):\n        if isinstance(obj, datetime):\n            return obj.isoformat()\n        return super().default(obj)\n\nprint(json.dumps({"now": datetime.now()}, cls=DateEncoder))', edgeCases: ['JSON doesn\'t support sets, tuples (converted to lists), bytes, or datetime by default.'], tags: ['json', 'serialize', 'parse'] },
        { id: 'ser-pickle', name: 'pickle Module', signature: 'pickle.dumps() / pickle.loads()', description: 'Serialize arbitrary Python objects to binary format. Can preserve complex types.', example: 'import pickle\n\ndata = {"name": "Alice", "scores": [1, 2, 3], "data": {1, 2, 3}}\n\n# Serialize to bytes\nblob = pickle.dumps(data)\nprint(type(blob))  # <class \'bytes\'>\n\n# Deserialize\nrestored = pickle.loads(blob)\nprint(restored)  # {\'name\': \'Alice\', ...}\n\n# File-based\nwith open("data.pkl", "wb") as f:\n    pickle.dump(data, f)\n\nwith open("data.pkl", "rb") as f:\n    loaded = pickle.load(f)', edgeCases: ['⚠️ SECURITY: Never unpickle untrusted data! pickle.loads can execute arbitrary code.'], tags: ['pickle', 'binary', 'serialize'] },
        { id: 'ser-yaml', name: 'YAML (PyYAML)', signature: 'yaml.safe_load() / yaml.safe_dump()', description: 'Human-readable data format. Common for config files.', example: 'import yaml\n\n# Parse YAML string\nconfig_str = """\ndatabase:\n  host: localhost\n  port: 5432\n  name: mydb\nfeatures:\n  - auth\n  - payments\n"""\n\nconfig = yaml.safe_load(config_str)\nprint(config["database"]["host"])  # localhost\n\n# Write YAML\ndata = {"name": "Alice", "options": {"debug": True}}\nprint(yaml.safe_dump(data, default_flow_style=False))', edgeCases: ['Always use safe_load/safe_dump.', 'yaml.load can execute arbitrary code!'], tags: ['yaml', 'config', 'human-readable'] },

        { id: 'ser-toml', name: 'TOML (tomllib)', signature: 'import tomllib (3.11+) | import tomli', description: 'Configuration file format. Used by pyproject.toml.', example: 'import tomllib  # Python 3.11+\n\nwith open("config.toml", "rb") as f:\n    config = tomllib.load(f)\n\nprint(config["database"]["host"])\nprint(config["features"])\n\n# TOML format:\n# [database]\n# host = "localhost"\n# port = 5432\n#\n# [features]\n# auth = true\n# max_users = 100', tags: ['toml', 'config', 'pyproject'] },
        { id: 'ser-base64', name: 'base64 Module', signature: 'base64.b64encode() / base64.b64decode()', description: 'Encode binary data as ASCII text. Used for embedding images, API tokens, email attachments.', example: 'import base64\n\n# Encode\ndata = b"Hello, World!"\nencoded = base64.b64encode(data)\nprint(encoded)  # b\'SGVsbG8sIFdvcmxkIQ==\'\n\n# Decode\ndecoded = base64.b64decode(encoded)\nprint(decoded)  # b\'Hello, World!\'\n\n# Encode file\nwith open("image.png", "rb") as f:\n    img_b64 = base64.b64encode(f.read()).decode("utf-8")\n    data_uri = f"data:image/png;base64,{img_b64}"', tags: ['base64', 'encode', 'binary'] },
        { id: 'ser-struct', name: 'struct Module', signature: 'struct.pack(format, v1, v2, ...) / struct.unpack(format, buffer)', description: 'Pack/unpack binary data for network protocols and binary file formats.', example: 'import struct\n\n# Pack Python values to bytes\ndata = struct.pack(">ihf", 42, 1000, 3.14)\nprint(data)  # b\'\\x00\\x00\\x00*\\x03\\xe8@H\\xf5\\xc3\'\nprint(len(data))  # 10 bytes\n\n# Unpack bytes to Python values\nvalues = struct.unpack(">ihf", data)\nprint(values)  # (42, 1000, 3.140000104904175)\n\n# Format chars: i=int, h=short, f=float, s=string\n# > = big-endian, < = little-endian', tags: ['struct', 'binary', 'pack'] },
        { id: 'ser-dataclasses-json', name: 'Dataclass Serialization', signature: 'N/A', description: 'Convert dataclasses to/from dicts and JSON.', example: 'from dataclasses import dataclass, asdict, astuple\nimport json\n\n@dataclass\nclass User:\n    name: str\n    age: int\n    email: str\n\nuser = User("Alice", 30, "alice@example.com")\n\n# To dict\nprint(asdict(user))\n# {\'name\': \'Alice\', \'age\': 30, \'email\': \'alice@example.com\'}\n\n# To JSON\nprint(json.dumps(asdict(user)))\n\n# To tuple\nprint(astuple(user))  # (\'Alice\', 30, \'alice@example.com\')\n\n# From dict\ndata = {"name": "Bob", "age": 25, "email": "bob@example.com"}\nuser2 = User(**data)', tags: ['dataclass', 'dict', 'json'] },
    ]
};
