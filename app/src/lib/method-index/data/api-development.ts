import { Category } from '../types';

export const apiDevelopment: Category = {
    id: 'api-development',
    name: 'API Development',
    description: 'Building and consuming REST APIs ‚Äî requests library, GraphQL, authentication, pagination, versioning',
    icon: 'Plug',
    entries: [
        { id: 'api-requests-get', name: 'requests.get()', signature: 'requests.get(url, params=None, headers=None) -> Response', description: 'Make HTTP GET requests. The most popular Python library for calling APIs.', example: 'import requests\n\n# Simple GET\nresponse = requests.get("https://api.github.com/users/python")\nprint(response.status_code)  # 200\nprint(response.json())  # Dict of user data\n\n# With query parameters\nresponse = requests.get("https://api.example.com/search", params={\n    "q": "python",\n    "page": 1,\n    "limit": 10\n})\n# URL: https://api.example.com/search?q=python&page=1&limit=10\n\n# With headers\nresponse = requests.get("https://api.example.com/data", headers={\n    "Authorization": "Bearer my-token",\n    "Accept": "application/json"\n})', tags: ['requests', 'get', 'http'] },
        { id: 'api-requests-post', name: 'requests.post()', signature: 'requests.post(url, json=None, data=None) -> Response', description: 'Make HTTP POST requests. Send JSON, form data, or file uploads.', example: 'import requests\n\n# JSON body\nresponse = requests.post("https://api.example.com/users", json={\n    "name": "Alice",\n    "email": "alice@example.com"\n})\nprint(response.json())\n\n# Form data\nresponse = requests.post("https://api.example.com/login", data={\n    "username": "alice",\n    "password": "secret"\n})\n\n# File upload\nwith open("photo.jpg", "rb") as f:\n    response = requests.post("https://api.example.com/upload", files={\n        "file": f\n    })', tags: ['requests', 'post', 'json'] },
        { id: 'api-requests-session', name: 'requests.Session()', signature: 'session = requests.Session()', description: 'Persist settings (authentication, headers, cookies) across requests for efficiency.', example: 'import requests\n\nsession = requests.Session()\nsession.headers.update({"Authorization": "Bearer my-token"})\n\n# All requests use the session headers\nusers = session.get("https://api.example.com/users").json()\nposts = session.get("https://api.example.com/posts").json()\n\n# Session with retry\nfrom requests.adapters import HTTPAdapter\nfrom urllib3.util.retry import Retry\n\nretry = Retry(total=3, backoff_factor=0.5)\nsession.mount("https://", HTTPAdapter(max_retries=retry))', tags: ['session', 'persist', 'efficient'] },
        { id: 'api-error-handling', name: 'API Error Handling', signature: 'response.raise_for_status()', description: 'Handle HTTP errors, timeouts, and connection issues gracefully.', example: 'import requests\n\ntry:\n    response = requests.get("https://api.example.com/data", timeout=5)\n    response.raise_for_status()  # Raises HTTPError for 4xx/5xx\n    data = response.json()\nexcept requests.exceptions.Timeout:\n    print("Request timed out")\nexcept requests.exceptions.ConnectionError:\n    print("Cannot connect to server")\nexcept requests.exceptions.HTTPError as e:\n    print(f"HTTP Error: {e.response.status_code}")\n    if e.response.status_code == 404:\n        print("Resource not found")\n    elif e.response.status_code == 401:\n        print("Unauthorized")\nexcept requests.exceptions.RequestException as e:\n    print(f"Request failed: {e}")', tags: ['error', 'timeout', 'retry'] },
        { id: 'api-rest-design', name: 'REST API Design', signature: 'N/A', description: 'Best practices for designing RESTful APIs ‚Äî URLs, methods, status codes, pagination.', example: '# RESTful URL patterns:\n# GET    /users          ‚Äî List users\n# POST   /users          ‚Äî Create user\n# GET    /users/{id}     ‚Äî Get single user\n# PUT    /users/{id}     ‚Äî Update user (full)\n# PATCH  /users/{id}     ‚Äî Update user (partial)\n# DELETE /users/{id}     ‚Äî Delete user\n\n# HTTP Status Codes:\n# 200 OK              ‚Äî Success (GET, PUT, PATCH)\n# 201 Created         ‚Äî Resource created (POST)\n# 204 No Content      ‚Äî Success, no body (DELETE)\n# 400 Bad Request     ‚Äî Invalid input\n# 401 Unauthorized    ‚Äî Not authenticated\n# 403 Forbidden       ‚Äî Not authorized\n# 404 Not Found       ‚Äî Resource doesn\'t exist\n# 422 Unprocessable   ‚Äî Validation error\n# 500 Server Error    ‚Äî Internal error', tags: ['rest', 'design', 'patterns'] },
        { id: 'api-auth-patterns', name: 'API Authentication', signature: 'N/A', description: 'Common authentication methods for APIs ‚Äî API keys, JWT, OAuth2.', example: 'import requests\n\n# 1. API Key (in header)\nresponse = requests.get("https://api.example.com/data", headers={\n    "X-API-Key": "my-api-key-123"\n})\n\n# 2. Bearer Token (JWT)\nresponse = requests.get("https://api.example.com/data", headers={\n    "Authorization": "Bearer eyJhbGciOiJIUzI1NiIs..."\n})\n\n# 3. Basic Auth\nresponse = requests.get("https://api.example.com/data",\n    auth=("username", "password")  # requests handles encoding\n)\n\n# 4. OAuth2 (simplified)\n# Step 1: Get authorization code via browser redirect\n# Step 2: Exchange code for token\ntoken_response = requests.post("https://oauth.example.com/token", data={\n    "grant_type": "authorization_code",\n    "code": "auth_code_from_redirect",\n    "client_id": "my-client-id",\n    "client_secret": "my-secret"\n})\naccess_token = token_response.json()["access_token"]', tags: ['auth', 'jwt', 'api-key', 'oauth2'] },
        { id: 'api-pagination', name: 'API Pagination', signature: 'N/A', description: 'Handle paginated API responses ‚Äî offset, cursor-based, and link-based patterns.', example: 'import requests\n\n# Offset-based pagination\ndef get_all_items():\n    items = []\n    page = 1\n    while True:\n        response = requests.get("https://api.example.com/items", params={\n            "page": page,\n            "per_page": 100\n        })\n        data = response.json()\n        if not data["results"]:\n            break\n        items.extend(data["results"])\n        page += 1\n    return items\n\n# Cursor-based pagination\ndef get_all_cursor():\n    items = []\n    cursor = None\n    while True:\n        params = {"limit": 100}\n        if cursor:\n            params["cursor"] = cursor\n        response = requests.get("https://api.example.com/items", params=params)\n        data = response.json()\n        items.extend(data["results"])\n        cursor = data.get("next_cursor")\n        if not cursor:\n            break\n    return items', tags: ['pagination', 'cursor', 'offset'] },
        { id: 'api-graphql', name: 'GraphQL (Basics)', signature: 'requests.post(url, json={"query": "..."})', description: 'Query APIs with GraphQL ‚Äî request exactly the data you need in a single request.', example: 'import requests\n\n# GraphQL query\nquery = """\n{\n    user(id: 1) {\n        name\n        email\n        posts {\n            title\n            created_at\n        }\n    }\n}\n"""\n\nresponse = requests.post("https://api.example.com/graphql", json={\n    "query": query\n})\ndata = response.json()["data"]\nprint(data["user"]["name"])\nfor post in data["user"]["posts"]:\n    print(f"  - {post[\'title\']}")\n\n# Mutation\nmutation = """\nmutation {\n    createUser(name: "Alice", email: "alice@example.com") {\n        id\n        name\n    }\n}\n"""\nresponse = requests.post("https://api.example.com/graphql", json={\n    "query": mutation\n})', tags: ['graphql', 'query', 'mutation'] },
        { id: 'api-mini-project', name: 'üî• Mini Project: Weather CLI', signature: 'Complete CLI app consuming a REST API', description: 'A command-line weather app that fetches data from a public API.', example: '# weather.py ‚Äî CLI weather app\nimport requests\nimport sys\n\ndef get_weather(city):\n    API_KEY = "your-api-key"\n    url = f"https://api.openweathermap.org/data/2.5/weather"\n    params = {"q": city, "appid": API_KEY, "units": "metric"}\n\n    response = requests.get(url, params=params)\n    if response.status_code == 404:\n        print(f"City \'{city}\' not found")\n        return\n\n    data = response.json()\n    print(f"\\nüåç Weather in {data[\'name\']}:")\n    print(f"  üå°Ô∏è  Temperature: {data[\'main\'][\'temp\']}¬∞C")\n    print(f"  üíß Humidity: {data[\'main\'][\'humidity\']}%")\n    print(f"  ‚òÅÔ∏è  Conditions: {data[\'weather\'][0][\'description\']}")\n    print(f"  üí® Wind: {data[\'wind\'][\'speed\']} m/s")\n\nif __name__ == "__main__":\n    city = " ".join(sys.argv[1:]) or "London"\n    get_weather(city)', tags: ['project', 'weather', 'cli'] },
    ]
};
