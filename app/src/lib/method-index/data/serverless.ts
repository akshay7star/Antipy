import { Category } from '../types';

export const serverlessCloud: Category = {
    id: 'serverless-cloud',
    name: 'Serverless & Cloud',
    description: 'AWS Lambda, Azure Functions, Docker — deploying Python applications to the cloud',
    icon: 'Cloud',
    entries: [
        { id: 'cloud-aws-lambda', name: 'AWS Lambda', signature: 'def handler(event, context): ...', description: 'Run Python functions in the cloud without managing servers. Pay only for compute time used.', example: '# lambda_function.py\nimport json\n\ndef handler(event, context):\n    """AWS Lambda handler function."""\n    body = json.loads(event.get("body", "{}"))\n    name = body.get("name", "World")\n\n    return {\n        "statusCode": 200,\n        "headers": {"Content-Type": "application/json"},\n        "body": json.dumps({"message": f"Hello, {name}!"})\n    }\n\n# Deploy with:\n# zip function.zip lambda_function.py\n# aws lambda create-function \\\n#   --function-name my-function \\\n#   --runtime python3.12 \\\n#   --handler lambda_function.handler \\\n#   --zip-file fileb://function.zip', tags: ['aws', 'lambda', 'serverless'] },
        { id: 'cloud-azure-funcs', name: 'Azure Functions', signature: '@app.route(route="endpoint")', description: 'Microsoft\'s serverless platform for running Python functions in the cloud.', example: 'import azure.functions as func\nimport json\n\napp = func.FunctionApp()\n\n@app.route(route="hello", methods=["GET", "POST"])\ndef hello(req: func.HttpRequest) -> func.HttpResponse:\n    name = req.params.get("name")\n    if not name:\n        body = req.get_json()\n        name = body.get("name", "World")\n\n    return func.HttpResponse(\n        json.dumps({"message": f"Hello, {name}!"}),\n        mimetype="application/json"\n    )\n\n# Timer trigger (cron)\n@app.timer_trigger(schedule="0 */5 * * * *", arg_name="timer")\ndef scheduled_task(timer: func.TimerRequest):\n    print("Running every 5 minutes")', tags: ['azure', 'functions', 'serverless'] },
        { id: 'cloud-docker', name: 'Docker for Python', signature: 'Dockerfile', description: 'Containerize Python applications for consistent deployment across environments.', example: '# Dockerfile\nFROM python:3.12-slim\n\nWORKDIR /app\n\n# Install dependencies\nCOPY requirements.txt .\nRUN pip install --no-cache-dir -r requirements.txt\n\n# Copy application\nCOPY . .\n\n# Expose port\nEXPOSE 8000\n\n# Run the application\nCMD ["uvicorn", "main:app", "--host", "0.0.0.0", "--port", "8000"]\n\n# Build and run:\n# docker build -t myapp .\n# docker run -p 8000:8000 myapp\n\n# docker-compose.yml:\n# services:\n#   web:\n#     build: .\n#     ports: ["8000:8000"]\n#   db:\n#     image: postgres:15\n#     environment:\n#       POSTGRES_PASSWORD: secret', tags: ['docker', 'container', 'deploy'] },
        { id: 'cloud-env-vars', name: 'Environment Variables', signature: 'os.environ.get("KEY", "default")', description: 'Manage configuration and secrets using environment variables instead of hardcoding.', example: 'import os\nfrom dotenv import load_dotenv\n\n# Load from .env file\nload_dotenv()\n\n# Access variables\nDATABASE_URL = os.environ.get("DATABASE_URL", "sqlite:///local.db")\nSECRET_KEY = os.environ["SECRET_KEY"]  # Raises KeyError if missing\nDEBUG = os.environ.get("DEBUG", "false").lower() == "true"\n\n# .env file:\n# DATABASE_URL=postgresql://user:pass@localhost/mydb\n# SECRET_KEY=super-secret-key-123\n# DEBUG=true', edgeCases: ['Never commit .env files or secrets to version control.', 'Use .env.example as a template.'], tags: ['env', 'config', 'secrets'] },

        { id: 'cloud-deploy-patterns', name: 'Deployment Patterns', signature: 'N/A', description: 'Common patterns for deploying Python web applications.', example: '# 1. WSGI/ASGI Servers (production)\n# gunicorn app:app --workers 4 --bind 0.0.0.0:8000\n# uvicorn main:app --workers 4 --host 0.0.0.0\n\n# 2. Reverse Proxy (Nginx)\n# upstream app {\n#     server 127.0.0.1:8000;\n# }\n# server {\n#     listen 80;\n#     location / { proxy_pass http://app; }\n# }\n\n# 3. Process Managers\n# systemd service file or supervisor config\n\n# 4. Platform-as-a-Service\n# Heroku: Procfile → web: gunicorn app:app\n# Railway, Render, Fly.io: Similar approach\n\n# 5. Container Orchestration\n# Docker Compose (dev)\n# Kubernetes (production scale)', tags: ['deploy', 'production', 'gunicorn'] },
    ]
};
